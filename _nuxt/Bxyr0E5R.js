import{d as T,M as C,v as E,N as B,s as H,J as c,n as U,o as u,c as h,e as o,a as r,t,f as p,b as a,K as k,w as v,h as N,i as x,T as j,j as K,a5 as S,g as z,k as A,C as $}from"./B_MjbVB3.js";import{_ as D}from"./BjB0lfe7.js";const J={class:"max-w-lg mx-auto my-16 min-h-[600px] lg:my-24"},W={class:"flex flex-col items-center"},F={class:"text-xl font-semibold lg:text-3xl"},G={for:"password",class:"mb-4"},O={for:"confirmPassword",class:"mb-4"},Q={key:0,class:"text-sm mb-4"},X=["innerHTML"],Y={class:"flex items-center justify-center gap-4 mt-4 text-lg"},Z={class:"my-8 text-center cursor-pointer"},ss=T({__name:"ResetPassword",setup(V){const{t:n}=C(),i=E(),d=B(),{viewer:L,resetPasswordWithKey:R,loginUser:q}=H(),l=c(""),m=c(""),f=c(""),g=c(!1),w=c(!1);!d.query.key&&!d.query.login&&i.push("/my-account?action=forgotPassword");const I=async()=>{try{if(f.value="",w.value=!1,g.value=!0,l.value!==m.value)throw new Error(n("messages.error.passwordMismatch"));const e={key:d.query.key,login:d.query.login,password:l.value};if(!e.key||!e.login)throw w.value=!0,new Error(n("messages.error.invalidPasswordResetLink"));const s=await R(e);if(!s.success)throw w.value=!0,new Error(s.error);if(L.value){const _=await q({username:e.login,password:e.password});if(!_.success)throw new Error(_.error)}i.push("/my-account")}catch(e){f.value=e.message||n("messages.error.general")}finally{g.value=!1}};return U({title:n("messages.account.resetPassword")}),(e,s)=>{const _=S,P=D,b=z,M=A;return u(),h("div",J,[o("div",W,[r(_,{class:"mb-6 scale-125"}),o("h1",F,t(e.$t("messages.account.resetPassword")),1)]),o("form",{class:"mt-6 flex flex-col",onSubmit:K(I,["prevent"])},[o("label",G,[p(t(e.$t("messages.account.newPassword"))+" ",1),s[2]||(s[2]=o("span",{class:"text-red-500"},"*",-1)),s[3]||(s[3]=o("br",null,null,-1)),r(P,{id:"password",className:" border rounded-lg w-full p-3 px-4 bg-white",modelValue:a(l),"onUpdate:modelValue":s[0]||(s[0]=y=>k(l)?l.value=y:null),placeholder:"New Password",required:!0},null,8,["modelValue"])]),o("label",O,[p(t(e.$t("messages.account.confirmNewPassword"))+" ",1),s[4]||(s[4]=o("span",{class:"text-red-500"},"*",-1)),s[5]||(s[5]=o("br",null,null,-1)),r(P,{id:"confirmPassword",className:"border rounded-lg w-full p-3 px-4 bg-white",modelValue:a(m),"onUpdate:modelValue":s[1]||(s[1]=y=>k(m)?m.value=y:null),placeholder:"Confirm Password",required:!0},null,8,["modelValue"])]),r(j,{name:"scale-y",mode:"out-in"},{default:v(()=>[a(f)?(u(),h("div",Q,[o("span",{class:"text-red-500",innerHTML:a(f)},null,8,X),a(w)?(u(),N(b,{key:0,class:"underline cursor-pointer pl-1",to:"/my-account?action=forgotPassword"},{default:v(()=>[p(t(e.$t("messages.account.requestNewLink")),1)]),_:1})):x("",!0)])):x("",!0)]),_:1}),o("button",Y,[a(g)?(u(),N(M,{key:0,stroke:"4",size:"16",color:"#fff"})):x("",!0),o("span",null,t(e.$t("messages.account.resetPassword")),1)])],32),o("div",Z,[r(b,{to:"/my-account"},{default:v(()=>[p(t(e.$t("messages.account.backToLogin")),1)]),_:1})])])}}}),es=$(ss,[["__scopeId","data-v-fd1df6fc"]]),os={},ts={class:"container min-h-[600px]"};function as(V,n){const i=es;return u(),h("div",ts,[r(i)])}const ls=$(os,[["render",as]]);export{ls as default};
