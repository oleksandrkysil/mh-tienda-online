import{q as ce,s as oe,u as A,G as Ue,v as Ee,x as Te,y as Le,d as H,z as ne,o as r,c as p,e as t,t as u,A as w,B as S,b as e,i as _,a as $,C as he,F as O,r as ee,D as le,E as ye,_ as te,H as ae,I as ge,h as P,J as j,K as Pe,j as _e,w as I,T as J,k as ie,f as K,L as Ae,M as Ie,N as Ne,m as De,O as qe,P as je,Q as pe,R as Oe,g as He,S as ze}from"./B_MjbVB3.js";import{_ as Be}from"./BjB0lfe7.js";import{_ as ve,a as be}from"./8Uzpo2uw.js";import{a as Ge}from"./DsOxRZbJ.js";import"./lLhPAuQ-.js";import"./CCcEhoxN.js";import"./BN9yBX4H.js";const Re=window.setInterval;function re(){const m=ce("orderInput",()=>({customerNote:"",paymentMethod:"",shipToDifferentAddress:!1,metaData:[{key:"order_via",value:"WooNuxt"}]})),l=ce("isProcessingOrder",()=>!1);async function i(){var c;const{customer:o,viewer:d}=oe(),{isUpdatingCart:g,refreshCart:a}=A();g.value=!0;try{const{updateCustomer:f}=await Ue({input:{id:(c=d==null?void 0:d.value)==null?void 0:c.id,shipping:m.value.shipToDifferentAddress?o.value.shipping:o.value.billing,billing:o.value.billing}});f&&a()}catch(f){console.error(f)}}function n(o){return new Promise(d=>{const c=window.innerWidth/2-375,f=window.innerHeight/2-750/2+80,v=window.open(o,"",`width=750,height=750,top=${f},left=${c}`),k=Re(()=>{v!=null&&v.closed&&(clearInterval(k),d(!0))},500)})}return{orderInput:m,isProcessingOrder:l,proccessCheckout:async(o=!1)=>{var M,U,q,B,Z;const{customer:d,loginUser:g}=oe(),a=Ee(),{replaceQueryParam:c}=Te(),{emptyCart:f,refreshCart:v}=A();l.value=!0;const{username:k,password:z,shipToDifferentAddress:N}=m.value,D=(M=d.value)==null?void 0:M.billing,se=N?(U=d.value)==null?void 0:U.shipping:D;try{let E={billing:D,shipping:se,metaData:m.value.metaData,paymentMethod:m.value.paymentMethod.id,customerNote:m.value.customerNote,shipToDifferentAddress:N,transactionId:m.value.transactionId,isPaid:o};m.value.createAccount&&(E.account={username:k,password:z});const{checkout:b}=await Le(E);m.value.createAccount&&await g({username:k,password:z});const G=(q=b==null?void 0:b.order)==null?void 0:q.databaseId,R=(B=b==null?void 0:b.order)==null?void 0:B.orderKey,W=m.value.paymentMethod.id,y=W==="paypal"||W==="ppcp-gateway";if(await(b==null?void 0:b.redirect)&&y){const h=window.location.origin;let C=(b==null?void 0:b.redirect)??"";const T=`${h}/checkout/order-received/${G}/?key=${R}&from_paypal=true`,V=`${h}/checkout/?cancel_order=true&from_paypal=true`;C=c("return",T,C),C=c("cancel_return",V,C),C=c("bn","WooNuxt_Cart",C),await n(C)&&a.push(`/checkout/order-received/${G}/?key=${R}&fetch_delay=true`)}else a.push(`/checkout/order-received/${G}/?key=${R}`);if(await(b==null?void 0:b.result)!=="success")return alert("There was an error processing your order. Please try again."),window.location.reload(),b;await f(),await v()}catch(E){l.value=!1;const b=(Z=E==null?void 0:E.gqlErrors)==null?void 0:Z[0].message;return b!=null&&b.includes("An account is already registered with your email address")?(alert("An account is already registered with your email address"),null):(alert(b),null)}l.value=!1},updateShippingLocation:i}}const We={class:"grid w-full gap-4 lg:grid-cols-2"},Ye={class:"w-full"},Fe={for:"first-name"},Ke={class:"w-full"},Je={for:"last-name"},Ze={key:0,class:"w-full col-span-full"},Qe={for:"address1"},Xe={key:1,class:"w-full col-span-full",style:{display:"none"}},et={for:"address2"},tt={key:2,class:"w-full col-span-full"},st={for:"country"},ot={key:3,class:"w-full"},nt={for:"state"},lt={key:4,class:"w-full"},at={for:"city"},it={key:5,class:"w-full",style:{display:"none"}},rt={for:"zip"},dt={key:6,class:"w-full col-span-full"},ut={for:"phone"},ct=H({__name:"BillingDetails",props:{modelValue:{type:Object,required:!0}},setup(m){const{updateShippingLocation:l}=re(),{isBillingAddressEnabled:i}=A(),s=ne(m,"modelValue");return(o,d)=>{const g=ve,a=be;return r(),p("div",We,[t("div",Ye,[t("label",Fe,u(o.$t("messages.billing.firstName")),1),w(t("input",{id:"first-name","onUpdate:modelValue":d[0]||(d[0]=c=>e(s).firstName=c),placeholder:"John",autocomplete:"given-name",type:"text",required:""},null,512),[[S,e(s).firstName]])]),t("div",Ke,[t("label",Je,u(o.$t("messages.billing.lastName")),1),w(t("input",{id:"last-name","onUpdate:modelValue":d[1]||(d[1]=c=>e(s).lastName=c),placeholder:"Doe",autocomplete:"family-name",type:"text",required:""},null,512),[[S,e(s).lastName]])]),e(i)?(r(),p("div",Ze,[t("label",Qe,u(o.$t("messages.billing.address1")),1),w(t("input",{id:"address1","onUpdate:modelValue":d[2]||(d[2]=c=>e(s).address1=c),placeholder:"O'Connell Street 47",autocomplete:"street-address",type:"text",required:""},null,512),[[S,e(s).address1]])])):_("",!0),e(i)?(r(),p("div",Xe,[t("label",et,u(o.$t("messages.billing.address2"))+" ("+u(o.$t("messages.general.optional"))+")",1),w(t("input",{id:"address2","onUpdate:modelValue":d[3]||(d[3]=c=>e(s).address2=c),placeholder:"Apartment, studio, or floor",autocomplete:"address-line2",type:"text"},null,512),[[S,e(s).address2]])])):_("",!0),e(i)?(r(),p("div",tt,[t("label",st,u(o.$t("messages.billing.country")),1),$(g,{id:"country",modelValue:e(s).country,"onUpdate:modelValue":d[4]||(d[4]=c=>e(s).country=c),"default-value":e(s).country,onChange:e(l),autocomplete:"country"},null,8,["modelValue","default-value","onChange"])])):_("",!0),e(i)?(r(),p("div",ot,[t("label",nt,u(o.$t("messages.billing.state"))+" ("+u(o.$t("messages.general.optional"))+")",1),$(a,{id:"state",modelValue:e(s).state,"onUpdate:modelValue":d[5]||(d[5]=c=>e(s).state=c),"default-value":e(s).state,"country-code":e(s).country,onChange:e(l),autocomplete:"address-level1"},null,8,["modelValue","default-value","country-code","onChange"])])):_("",!0),e(i)?(r(),p("div",lt,[t("label",at,u(o.$t("messages.billing.city")),1),w(t("input",{id:"city","onUpdate:modelValue":d[6]||(d[6]=c=>e(s).city=c),placeholder:"New York",autocomplete:"locality",type:"text",required:""},null,512),[[S,e(s).city]])])):_("",!0),e(i)?(r(),p("div",it,[t("label",rt,u(o.$t("messages.billing.zip")),1),w(t("input",{id:"zip","onUpdate:modelValue":d[7]||(d[7]=c=>e(s).postcode=c),placeholder:"10001",autocomplete:"postal-code",type:"text"},null,512),[[S,e(s).postcode]])])):_("",!0),e(i)?(r(),p("div",dt,[t("label",ut,u(o.$t("messages.billing.phone"))+" ("+u(o.$t("messages.general.optional"))+")",1),w(t("input",{id:"phone","onUpdate:modelValue":d[8]||(d[8]=c=>e(s).phone=c),placeholder:"+1 234 567 8901",autocomplete:"tel",type:"tel"},null,512),[[S,e(s).phone]])])):_("",!0)])}}}),pt={class:"grid w-full gap-4 lg:grid-cols-2"},mt={class:"w-full"},ft={for:"first-name"},ht={class:"w-full"},yt={for:"last-name"},gt={class:"w-full col-span-full"},_t={for:"address1"},vt={class:"w-full col-span-full"},bt={for:"address2"},$t={class:"w-full"},wt={for:"city"},xt={class:"w-full"},kt={for:"state"},St={class:"w-full"},Ct={for:"country"},Vt={class:"w-full"},Mt={for:"zip"},Ut={class:"w-full col-span-full"},Et={for:"phone"},Tt=H({__name:"ShippingDetails",props:{modelValue:{type:Object,required:!0}},setup(m){const{updateShippingLocation:l}=re(),n=ne(m,"modelValue");return(s,o)=>{const d=be,g=ve;return r(),p("div",pt,[t("div",mt,[t("label",ft,u(s.$t("messages.billing.firstName")),1),w(t("input",{id:"first-name","onUpdate:modelValue":o[0]||(o[0]=a=>e(n).firstName=a),placeholder:"John",autocomplete:"given-name",type:"text",required:""},null,512),[[S,e(n).firstName]])]),t("div",ht,[t("label",yt,u(s.$t("messages.billing.lastName")),1),w(t("input",{id:"last-name","onUpdate:modelValue":o[1]||(o[1]=a=>e(n).lastName=a),placeholder:"Doe",autocomplete:"family-name",type:"text",required:""},null,512),[[S,e(n).lastName]])]),t("div",gt,[t("label",_t,u(s.$t("messages.billing.address1")),1),w(t("input",{id:"address1","onUpdate:modelValue":o[2]||(o[2]=a=>e(n).address1=a),placeholder:"O'Connell Street 47",autocomplete:"street-address",type:"text",required:""},null,512),[[S,e(n).address1]])]),t("div",vt,[t("label",bt,u(s.$t("messages.billing.address2"))+" ("+u(s.$t("messages.general.optional"))+")",1),w(t("input",{id:"address2","onUpdate:modelValue":o[3]||(o[3]=a=>e(n).address2=a),placeholder:"Apartment, studio, or floor",autocomplete:"address-line2",type:"text"},null,512),[[S,e(n).address2]])]),t("div",$t,[t("label",wt,u(s.$t("messages.billing.city")),1),w(t("input",{id:"city","onUpdate:modelValue":o[4]||(o[4]=a=>e(n).city=a),placeholder:"New York",autocomplete:"locality",type:"text",required:""},null,512),[[S,e(n).city]])]),t("div",xt,[t("label",kt,u(s.$t("messages.billing.state"))+" ("+u(s.$t("messages.general.optional"))+")",1),$(d,{id:"state",modelValue:e(n).state,"onUpdate:modelValue":o[5]||(o[5]=a=>e(n).state=a),"default-value":e(n).state,"country-code":e(n).country,onChange:e(l)},null,8,["modelValue","default-value","country-code","onChange"])]),t("div",St,[t("label",Ct,u(s.$t("messages.billing.country")),1),$(g,{id:"country",modelValue:e(n).country,"onUpdate:modelValue":o[6]||(o[6]=a=>e(n).country=a),"default-value":e(n).country,onChange:e(l)},null,8,["modelValue","default-value","onChange"])]),t("div",Vt,[t("label",Mt,u(s.$t("messages.billing.zip")),1),w(t("input",{id:"zip","onUpdate:modelValue":o[7]||(o[7]=a=>e(n).postcode=a),placeholder:"10001",autocomplete:"postal-code",type:"text",required:""},null,512),[[S,e(n).postcode]])]),t("div",Ut,[t("label",Et,u(s.$t("messages.billing.phone"))+" ("+u(s.$t("messages.general.optional"))+")",1),w(t("input",{id:"phone","onUpdate:modelValue":o[8]||(o[8]=a=>e(n).phone=a),placeholder:"+1 234 567 8901",autocomplete:"tel",type:"tel"},null,512),[[S,e(n).phone]])])])}}}),Lt={class:"grid gap-4 shipping-options"},Pt=["onClick"],At=["innerHTML"],It={class:"font-semibold text-gray-600"},Nt={__name:"ShippingOptions",props:{options:{type:Array,required:!0},activeOption:{type:String,required:!0}},setup(m){var o;const{updateShippingMethod:l}=A(),i=ye(),n=((o=i==null?void 0:i.public)==null?void 0:o.CURRENCY_SYMBOL)||"$",s=async d=>{await l(d)};return(d,g)=>{const a=te;return r(),p("div",Lt,[(r(!0),p(O,null,ee(m.options,c=>(r(),p("div",{key:c.id,class:le(["flex items-center justify-between option",{"active-option":c.id===m.activeOption}]),onClick:f=>s(c.id)},[t("div",null,[t("div",{class:"text-sm leading-tight text-gray-500",innerHTML:c.label},null,8,At),t("div",It,u(e(n))+u(c.cost),1)]),$(a,{name:"ion:checkmark-circle",size:"20",class:"ml-auto text-primary checkmark opacity-0"})],10,Pt))),128))])}}},Dt=he(Nt,[["__scopeId","data-v-9043ed77"]]),qt={class:"flex gap-4 leading-tight flex-wrap"},jt=["onClick","title"],Ot=["innerHTML"],Ht={key:0,class:"prose block w-full"},zt=["innerHTML"],Bt=H({__name:"PaymentOptions",props:{modelValue:{},paymentGateways:{}},emits:["update:modelValue"],setup(m,{emit:l}){const i=m,n=ne(i,"modelValue"),s=ae(()=>n.value),o=l,d=g=>{o("update:modelValue",g)};return ge(()=>{var g,a;(g=i.paymentGateways)!=null&&g.nodes.length&&d((a=i.paymentGateways)==null?void 0:a.nodes[0])}),(g,a)=>{var f;const c=te;return r(),p("div",qt,[(r(!0),p(O,null,ee((f=g.paymentGateways)==null?void 0:f.nodes,v=>(r(),p("div",{key:v.id,class:le(["option",{"active-option":v.id===e(s).id}]),onClick:k=>d(v),title:(v==null?void 0:v.description)||(v==null?void 0:v.title)||"Payment Method"},[v.id==="stripe"?(r(),P(c,{key:0,name:"ion:card-outline",size:"20"})):v.id==="paypal"?(r(),P(c,{key:1,name:"ion:logo-paypal",size:"20"})):(r(),P(c,{key:2,name:"ion:cash-outline",size:"20"})),t("span",{class:"whitespace-nowrap",innerHTML:v.title},null,8,Ot),$(c,{name:"ion:checkmark-circle",size:"20",class:"ml-auto text-primary checkmark opacity-0"})],10,jt))),128)),e(s).description?(r(),p("div",Ht,[t("p",{class:"text-sm text-gray-500",innerHTML:e(s).description},null,8,zt)])):_("",!0)])}}}),Gt=he(Bt,[["__scopeId","data-v-e7723a37"]]),Rt={id:"card-element"},Wt=H({__name:"StripeElement",props:["stripe"],emits:["updateElement"],setup(m,{emit:l}){const{cart:i}=A(),n=ae(()=>i.value&&parseFloat(i.value.rawTotal)*100),s=l;let o=null;const d={mode:"payment",currency:"eur",amount:n.value},g=async()=>{o=m.stripe.elements(d),o.create("card",{hidePostalCode:!0}).mount("#card-element"),s("updateElement",o)};return ge(()=>{g()}),(a,c)=>(r(),p("div",Rt))}}),Yt=["placeholder"],Ft=["disabled"],Kt={key:1},Jt=["innerHTML"],Zt={key:0,class:"text-xs font-semibold uppercase flex flex-wrap gap-2"},Qt={key:0,class:"bg-primary border-primary border rounded-md flex bg-opacity-5 border-opacity-10 text-primary leading-none p-1.5 gap-1 items-center"},Xt=["innerHTML"],es=H({__name:"AddCoupon",setup(m){const{cart:l,isUpdatingCoupon:i,applyCoupon:n,removeCoupon:s}=A(),o=j(""),d=j("");async function g(){const{message:a}=await n(o.value);a?d.value=a:(o.value="",d.value="")}return(a,c)=>{const f=ie,v=te;return r(),p("div",null,[t("form",{class:"flex gap-1",onSubmit:_e(g,["prevent"])},[w(t("input",{id:"couponCode","onUpdate:modelValue":c[0]||(c[0]=k=>Pe(o)?o.value=k:null),type:"text",placeholder:a.$t("messages.shop.couponCode"),class:"w-full px-4 py-2 bg-white border border-gray-300 rounded-md shadow-sm outline-none",required:""},null,8,Yt),[[S,e(o)]]),t("button",{class:"flex items-center justify-center px-4 py-2 text-white bg-gray-800 border rounded-md shadow-sm outline-none min-w-20",disabled:e(i)},[e(i)?(r(),P(f,{key:0,color:"#fff",size:"16"})):(r(),p("span",Kt,u(a.$t("messages.general.apply")),1))],8,Ft)],32),$(J,{name:"scale-y",mode:"out-in"},{default:I(()=>[e(d)?(r(),p("div",{key:0,class:"mt-2 text-xs text-red-600",innerHTML:e(d)},null,8,Jt)):_("",!0)]),_:1}),$(J,{name:"scale-y",mode:"out-in"},{default:I(()=>[e(l)&&e(l).appliedCoupons?(r(),p("div",Zt,[(r(!0),p(O,null,ee(e(l).appliedCoupons,(k,z)=>(r(),p("div",{key:(k==null?void 0:k.code)||z,class:"flex flex-wrap mt-2 flex-2"},[k!=null&&k.code?(r(),p("div",Qt,[t("span",{innerHTML:k.code},null,8,Xt),$(v,{name:"ion:close",class:"rounded-full cursor-pointer hover:bg-primary hover:text-white",onClick:N=>e(s)(k.code)},null,8,["onClick"])])):_("",!0)]))),128))])):_("",!0)]),_:1})])}}}),ts={key:0,class:"bg-white rounded-lg shadow-lg mb-8 w-full min-h-[280px] p-4 sm:p-8 relative md:max-w-md md:top-32 md:sticky"},ss={class:"mb-6 text-xl font-semibold leading-none"},os={class:"flex flex-col gap-4 overflow-y-auto"},ns={class:"grid gap-1 text-sm font-semibold text-gray-500"},ls={class:"flex justify-between"},as=["innerHTML"],is={class:"flex justify-between"},rs={class:"text-gray-700 tabular-nums"},ds={key:0,class:"flex justify-between"},us={class:"text-primary tabular-nums"},cs=["innerHTML"],ps={class:"flex justify-between mt-4"},ms=["innerHTML"],fs={key:0,class:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-50"},hs={__name:"OrderSummary",setup(m){const{cart:l,isUpdatingCart:i}=A();return(n,s)=>{const o=Ge,d=es,g=ie;return e(l)?(r(),p("aside",ts,[t("h2",ss,u(n.$t("messages.shop.orderSummary")),1),t("ul",os,[(r(!0),p(O,null,ee(e(l).contents.nodes,a=>(r(),P(o,{key:a.key,item:a},null,8,["item"]))),128))]),$(d,{class:"my-8"}),t("div",ns,[t("div",ls,[t("span",null,u(n.$t("messages.shop.subtotal")),1),t("span",{class:"text-gray-700 tabular-nums",innerHTML:e(l).subtotal},null,8,as)]),t("div",is,[t("span",null,u(n.$t("messages.general.shipping")),1),t("span",rs,u(parseFloat(e(l).shippingTotal)>0?"+":"")+" "+u(e(l).shippingTotal),1)]),$(J,{name:"scale-y",mode:"out-in"},{default:I(()=>[e(l)&&e(l).appliedCoupons?(r(),p("div",ds,[t("span",null,u(n.$t("messages.shop.discount")),1),t("span",us,[s[0]||(s[0]=K("- ")),t("span",{innerHTML:e(l).discountTotal},null,8,cs)])])):_("",!0)]),_:1}),t("div",ps,[t("span",null,u(n.$t("messages.shop.total")),1),t("span",{class:"text-lg font-bold text-gray-700 tabular-nums",innerHTML:e(l).total},null,8,ms)])]),Ae(n.$slots,"default"),e(i)?(r(),p("div",fs,[$(g)])):_("",!0)])):_("",!0)}}};var $e="https://js.stripe.com/v3",ys=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,me="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",gs=function(){for(var l=document.querySelectorAll('script[src^="'.concat($e,'"]')),i=0;i<l.length;i++){var n=l[i];if(ys.test(n.src))return n}return null},fe=function(l){var i="",n=document.createElement("script");n.src="".concat($e).concat(i);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(n),n},_s=function(l,i){!l||!l._registerWrapper||l._registerWrapper({name:"stripe-js",version:"4.7.0",startTime:i})},Y=null,Q=null,X=null,vs=function(l){return function(){l(new Error("Failed to load Stripe.js"))}},bs=function(l,i){return function(){window.Stripe?l(window.Stripe):i(new Error("Stripe.js not available"))}},$s=function(l){return Y!==null?Y:(Y=new Promise(function(i,n){if(typeof window>"u"||typeof document>"u"){i(null);return}if(window.Stripe&&l&&console.warn(me),window.Stripe){i(window.Stripe);return}try{var s=gs();if(s&&l)console.warn(me);else if(!s)s=fe(l);else if(s&&X!==null&&Q!==null){var o;s.removeEventListener("load",X),s.removeEventListener("error",Q),(o=s.parentNode)===null||o===void 0||o.removeChild(s),s=fe(l)}X=bs(i,n),Q=vs(n),s.addEventListener("load",X),s.addEventListener("error",Q)}catch(d){n(d);return}}),Y.catch(function(i){return Y=null,Promise.reject(i)}))},ws=function(l,i,n){if(l===null)return null;var s=l.apply(void 0,i);return _s(s,n),s},F,we=!1,xe=function(){return F||(F=$s(null).catch(function(l){return F=null,Promise.reject(l)}),F)};Promise.resolve().then(function(){return xe()}).catch(function(m){we||console.warn(m)});var xs=function(){for(var l=arguments.length,i=new Array(l),n=0;n<l;n++)i[n]=arguments[n];we=!0;var s=Date.now();return xe().then(function(o){return ws(o,i,s)})};const ks={class:"flex flex-col min-h-[600px]"},Ss={key:0,class:"flex flex-col items-center justify-center flex-1 mb-12"},Cs={class:"text-2xl font-bold mb-2"},Vs={class:"text-gray-400 mb-4"},Ms={class:"grid w-full max-w-2xl gap-8 checkout-form md:flex-1"},Us={key:0},Es={class:"w-full mt-4"},Ts={for:"email"},Ls={key:0,class:"mt-1 text-sm text-red-500"},Ps={class:"w-full mt-4"},As={for:"username"},Is={key:0,class:"w-full my-2"},Ns={for:"email"},Ds={key:1,class:"flex items-center gap-2 my-2"},qs={class:"w-full mb-3 text-2xl font-semibold"},js={key:1,for:"shipToDifferentAddress",class:"flex items-center gap-2",style:{display:"none"}},Os={key:0},Hs={class:"mb-4 text-xl font-semibold"},zs={key:2},Bs={class:"mb-4 text-xl font-semibold"},Gs={key:3,class:"mt-2 col-span-full"},Rs={class:"mb-4 text-xl font-semibold"},Ws={class:"mb-4 text-xl font-semibold"},Ys=["placeholder"],Fs=["disabled"],so=H({__name:"checkout",async setup(m){var W;let l,i;const{t:n}=Ie(),{query:s}=Ne(),{cart:o,isUpdatingCart:d,paymentGateways:g}=A(),{customer:a,viewer:c}=oe(),{orderInput:f,isProcessingOrder:v,proccessCheckout:k}=re(),N=((W=ye().public)==null?void 0:W.STRIPE_PUBLISHABLE_KEY)||null,D=j(v.value?n("messages.general.processing"):n("messages.shop.checkoutButton")),se=ae(()=>v.value||d.value||!f.value.paymentMethod),M=j(!1),U=N?([l,i]=De(()=>xs(N)),l=await l,i(),l):null,q=j(),B=j(!1);qe(async()=>{s.cancel_order&&window.close()});const Z=async()=>{var C;D.value=n("messages.general.processing");const{stripePaymentIntent:y}=await ze(),h=(y==null?void 0:y.clientSecret)||"";try{if(f.value.paymentMethod.id==="stripe"&&U&&q.value){const T=q.value.getElement("card"),{setupIntent:V}=await U.confirmCardSetup(h,{payment_method:{card:T}}),{source:L}=await U.createSource(T);L&&f.value.metaData.push({key:"_stripe_source_id",value:L.id}),V&&f.value.metaData.push({key:"_stripe_intent_id",value:V.id}),B.value=(V==null?void 0:V.status)==="succeeded"||!1,f.value.transactionId=((C=L==null?void 0:L.created)==null?void 0:C.toString())||new Date().getTime().toString()}}catch(T){console.error(T),D.value=n("messages.shop.placeOrder")}k(B.value)},E=y=>{q.value=y},b=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/,G=y=>{y&&(M.value=!b.test(y))},R=y=>{y&&M.value&&(M.value=!b.test(y))};return je({title:n("messages.shop.checkout")}),(y,h)=>{var ue;const C=te,T=He,V=Be,L=ct,ke=Tt,Se=Dt,Ce=Gt,Ve=Wt,de=ie,Me=hs;return r(),p("div",ks,[e(o)&&e(a)?(r(),p(O,{key:0},[e(o).isEmpty?(r(),p("div",Ss,[$(C,{name:"ion:cart-outline",size:"156",class:"opacity-25 mb-5"}),t("h2",Cs,u(y.$t("messages.shop.cartEmpty")),1),t("span",Vs,u(y.$t("messages.shop.addProductsInYourCart")),1),$(T,{to:"/products",class:"flex items-center justify-center gap-3 p-2 px-3 mt-4 font-semibold text-center text-white rounded-lg shadow-md bg-primary hover:bg-primary-dark"},{default:I(()=>[K(u(y.$t("messages.shop.browseOurProducts")),1)]),_:1})])):(r(),p("form",{key:1,class:"container flex flex-wrap items-start gap-8 my-16 justify-evenly lg:gap-20",onSubmit:_e(Z,["prevent"])},[t("div",Ms,[!e(c)&&e(a).billing?(r(),p("div",Us,[h[12]||(h[12]=t("h2",{class:"w-full mb-2 text-2xl font-semibold leading-none"},"Contact Information",-1)),h[13]||(h[13]=t("p",{class:"mt-1 text-sm text-gray-500"},[K("Already have an account? "),t("a",{href:"/my-account",class:"text-primary text-semibold"},"Log in"),K(".")],-1)),t("div",Es,[t("label",Ts,u(y.$t("messages.billing.email")),1),w(t("input",{"onUpdate:modelValue":h[0]||(h[0]=x=>e(a).billing.email=x),placeholder:"johndoe@email.com",autocomplete:"email",type:"email",name:"email",class:le({"has-error":e(M)}),onBlur:h[1]||(h[1]=x=>G(e(a).billing.email)),onInput:h[2]||(h[2]=x=>R(e(a).billing.email)),required:""},null,34),[[S,e(a).billing.email]]),$(J,{name:"scale-y",mode:"out-in"},{default:I(()=>[e(M)?(r(),p("div",Ls,"Invalid email address")):_("",!0)]),_:1})]),e(f).createAccount?(r(),p(O,{key:0},[t("div",Ps,[t("label",As,u(y.$t("messages.account.username")),1),w(t("input",{"onUpdate:modelValue":h[3]||(h[3]=x=>e(f).username=x),placeholder:"johndoe",autocomplete:"username",type:"text",name:"username",required:""},null,512),[[S,e(f).username]])]),e(f).createAccount?(r(),p("div",Is,[t("label",Ns,u(y.$t("messages.account.password")),1),$(V,{id:"password",class:"my-2",modelValue:e(f).password,"onUpdate:modelValue":h[4]||(h[4]=x=>e(f).password=x),placeholder:"••••••••••",required:!0},null,8,["modelValue"])])):_("",!0)],64)):_("",!0),e(c)?_("",!0):(r(),p("div",Ds,[h[11]||(h[11]=t("label",{for:"creat-account"},"Create an account?",-1)),w(t("input",{id:"creat-account","onUpdate:modelValue":h[5]||(h[5]=x=>e(f).createAccount=x),type:"checkbox",name:"creat-account"},null,512),[[pe,e(f).createAccount]])]))])):_("",!0),t("div",null,[t("h2",qs,u(y.$t("messages.billing.billingDetails")),1),$(L,{modelValue:e(a).billing,"onUpdate:modelValue":h[6]||(h[6]=x=>e(a).billing=x)},null,8,["modelValue"])]),e(o).availableShippingMethods.length>0?(r(),p("label",js,[t("span",null,u(y.$t("messages.billing.differentAddress")),1),w(t("input",{id:"shipToDifferentAddress","onUpdate:modelValue":h[7]||(h[7]=x=>e(f).shipToDifferentAddress=x),type:"checkbox",name:"shipToDifferentAddress"},null,512),[[pe,e(f).shipToDifferentAddress]])])):_("",!0),$(J,{name:"scale-y",mode:"out-in"},{default:I(()=>[e(f).shipToDifferentAddress?(r(),p("div",Os,[t("h2",Hs,u(y.$t("messages.general.shippingDetails")),1),$(ke,{modelValue:e(a).shipping,"onUpdate:modelValue":h[8]||(h[8]=x=>e(a).shipping=x)},null,8,["modelValue"])])):_("",!0)]),_:1}),e(o).availableShippingMethods.length?(r(),p("div",zs,[t("h3",Bs,u(y.$t("messages.general.shippingSelect")),1),$(Se,{options:e(o).availableShippingMethods[0].rates,"active-option":e(o).chosenShippingMethods[0]},null,8,["options","active-option"])])):_("",!0),(ue=e(g))!=null&&ue.nodes.length?(r(),p("div",Gs,[t("h2",Rs,u(y.$t("messages.billing.paymentOptions")),1),$(Ce,{modelValue:e(f).paymentMethod,"onUpdate:modelValue":h[9]||(h[9]=x=>e(f).paymentMethod=x),class:"mb-4",paymentGateways:e(g)},null,8,["modelValue","paymentGateways"]),e(U)?w((r(),P(Ve,{key:0,stripe:e(U),onUpdateElement:E},null,8,["stripe"])),[[Oe,e(f).paymentMethod.id=="stripe"]]):_("",!0)])):_("",!0),t("div",null,[t("h2",Ws,u(y.$t("messages.shop.orderNote"))+" ("+u(y.$t("messages.general.optional"))+")",1),w(t("textarea",{id:"order-note","onUpdate:modelValue":h[10]||(h[10]=x=>e(f).customerNote=x),name:"order-note",class:"w-full min-h-[100px]",rows:"4",placeholder:y.$t("messages.shop.orderNotePlaceholder")},null,8,Ys),[[S,e(f).customerNote]])])]),$(Me,null,{default:I(()=>[t("button",{class:"flex items-center justify-center w-full gap-3 p-3 mt-4 font-semibold text-center text-white rounded-lg shadow-md bg-primary hover:bg-primary-dark disabled:cursor-not-allowed disabled:bg-gray-400",disabled:e(se)},[K(u(e(D)),1),e(v)?(r(),P(de,{key:0,color:"#fff",size:"18"})):_("",!0)],8,Fs)]),_:1})],32))],64)):(r(),P(de,{key:1,class:"m-auto"}))])}}});export{so as default};
