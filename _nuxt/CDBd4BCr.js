import{H as i,an as u,a8 as h,d as _,ao as w,J as v,ap as A,I as k,o as x,c as B,ah as I,b as p}from"./BQsMxEgi.js";function N(e){var o;(o=performance==null?void 0:performance.mark)==null||o.call(performance,"mark_feature_usage",{detail:{feature:e}})}const E={src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[Number,String],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:String,required:!1},sizes:{type:[Object,String],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},alt:{type:String,required:!1},referrerpolicy:{type:String,required:!1},usemap:{type:String,required:!1},longdesc:{type:String,required:!1},ismap:{type:Boolean,required:!1},loading:{type:String,required:!1,validator:e=>["lazy","eager"].includes(e)},crossorigin:{type:[Boolean,String],required:!1,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,required:!1,validator:e=>["async","auto","sync"].includes(e)},nonce:{type:[String],required:!1}},j=e=>{const o=i(()=>({provider:e.provider,preset:e.preset})),t=i(()=>({width:u(e.width),height:u(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding,nonce:e.nonce})),g=h(),a=i(()=>({...e.modifiers,width:u(e.width),height:u(e.height),format:e.format,quality:e.quality||g.options.quality,background:e.background,fit:e.fit}));return{options:o,attrs:t,modifiers:a}},C={...E,placeholder:{type:[Boolean,String,Number,Array],required:!1},placeholderClass:{type:String,required:!1}},O=["src"],L=_({__name:"NuxtImg",props:C,emits:["load","error"],setup(e,{emit:o}){const t=e,g=w(),a=o,q=!1,f=h(),s=j(t),c=v(!1),l=v(),d=i(()=>f.getSizes(t.src,{...s.options.value,sizes:t.sizes,densities:t.densities,modifiers:{...s.modifiers.value,width:u(t.width),height:u(t.height)}})),S=i(()=>{const r={...s.attrs.value,"data-nuxt-img":""};return(!t.placeholder||c.value)&&(r.sizes=d.value.sizes,r.srcset=d.value.srcset),r}),m=i(()=>{let r=t.placeholder;if(r===""&&(r=!0),!r||c.value)return!1;if(typeof r=="string")return r;const n=Array.isArray(r)?r:typeof r=="number"?[r,r]:[10,10];return f(t.src,{...s.modifiers.value,width:n[0],height:n[1],quality:n[2]||50,blur:n[3]||3},s.options.value)}),y=i(()=>t.sizes?d.value.src:f(t.src,s.modifiers.value,s.options.value)),b=i(()=>m.value?m.value:y.value),z=A().isHydrating;return k(()=>{if(m.value){const r=new Image;y.value&&(r.src=y.value),t.sizes&&(r.sizes=d.value.sizes||"",r.srcset=d.value.srcset),r.onload=n=>{c.value=!0,a("load",n)},N("nuxt-image");return}l.value&&(l.value.complete&&z&&(l.value.getAttribute("data-error")?a("error",new Event("error")):a("load",new Event("load"))),l.value.onload=r=>{a("load",r)},l.value.onerror=r=>{a("error",r)})}),(r,n)=>(x(),B("img",I({ref_key:"imgEl",ref:l,class:t.placeholder&&!c.value?t.placeholderClass:void 0},{...p(q)?{onerror:"this.setAttribute('data-error', 1)"}:{},...S.value,...p(g)},{src:b.value}),null,16,O))}});export{L as _};
